/*! Yin and Yang Core Framework v0.1.4 | Copyright (c) 2015 Ivan (3axap4eHko) Zakharchenko*/
"use strict";function _typeof(n){return n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n}function _toConsumableArray(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)}!function(n,t){function r(n,t,r){r=r||{},s(n)||s(n,{});var e=s(n);return e.hasOwnProperty(t)||(e[t]=r),e[t]}function e(n,t,r){return Object.keys(t).forEach(function(u){c.isStructure(n[u])&&c.isStructure(t[u])?e(n[u],t[u],r):n[u]=t[u]}),n}function u(){return Math.floor(4096+4095*Math.random()).toString(16)}function a(){return("0000"+Date.now().toString("16")).slice(-12)}function o(n){for(var r=arguments.length,e=Array(r>1?r-1:0),u=1;r>u;u++)e[u-1]=arguments[u];return n.shift().apply(t,e.concat([function(){o.apply(t,[n].concat(e))}]))}function i(n,t){return r(n,p)[t]=r(n,p)[t]||[]}var f=n.hasOwnProperty("process")?!!n.process.version:!1,c={DEBUG:0,get isNode(){return f}};n.dbg=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];t.forEach(function(n){console.log(n)}),f&&process.exit(0)},n.dmp=function(n,t){return console.log(t+": "+n),n},n.watch=function(n){var t=new Date;return n(),(new Date).getTime()-t.getTime()},n.test=function(t,r){return n.watch(function(){for(;t--;)r(t)})},c.p=function(){var n=new WeakMap;return function(t,r,e){if(2===arguments.length)return n.set(t,r);if(1===arguments.length)return n.get(t);if(3===arguments.length&&e)return n.remove(t);throw new Error("Private scope storage called with wrong count of arguments: "+arguments.length)}};var s=c.p();c.classOf=function(n){return Object.prototype.toString.call(n).slice(8,-1)},c.is=function(n,t){return c.classOf(n)==t.name},c.isArray=function(n){return c.is(n,Array)},c.isNumber=function(n){return c.is(n,Number)},c.isInteger=function(n){return Number.isInteger(n)},c.isFiniteNumber=function(n){return c.isNumber(n)&&isFinite(n)},c.isDate=function(n){return c.is(n,Date)},c.isString=function(n){return c.is(n,String)},c.isNotEmptyString=function(n){return c.isString(n)&&n.length>0},c.isObject=function(n){return c.is(n,Object)},c.isFunction=function(n){return c.is(n,Function)},c.isBoolean=function(n){return c.is(n,Boolean)},c.isDefined=function(n){return"undefined"!=typeof n},c.isNull=function(n){return null===n},c.isValue=function(n){return c.isDefined(n)&&!c.isNull(n)},c.isStructure=function(n){return c.isObject(n)||c.isArray(n)},c.isIterated=function(n){return c.isObject(n)||c.isArray(n)||c.isString(n)},c.isKeyValue=function(n){return c.isObject(n)&&n.hasOwnProperty("key")&&n.hasOwnProperty("value")},c.areEqual=function(n,r){if(null===n||n===t||null===r||r===t)return n===r;if(n.constructor!==r.constructor)return!1;if(n instanceof Function)return n===r;if(n instanceof RegExp)return n===r;if(n===r||n.valueOf()===r.valueOf())return!0;if(Array.isArray(n)&&n.length!==r.length)return!1;if(n instanceof Date)return!1;if(!(n instanceof Object))return!1;if(!(r instanceof Object))return!1;var e=c.keys(n);return c.keys(r).every(function(n){return-1!==e.indexOf(n)})&&e.every(function(t){return c.areEqual(n[t],r[t])})},c.toInt=function(n){return isFinite(n=parseInt(n))?n:0},c.toIntOrDefault=function(n,t){return isFinite(n=parseInt(n))?n:t||0},c.toFloat=function(n){return isFinite(n=parseFloat(n))?n:0},c.toFloatOrDefault=function(n,t){return isFinite(n=parseFloat(n))?n:t||0},c.toArray=Array.from,c.toArrayOf=Array.of,c.toKeyValue=function(n,t){return{key:n,value:t}},c.toKeyValueOf=function(n,t){return{key:t,value:n[t]}},c.toString=function(n){return c.isValue(n)?n.toString():""},c.toJsonString=function(n){return JSON.stringify(n)},c.toJsonObject=function(n){return JSON.parse(n)},c.toCharCodes=function(n){return c.toArray(n.toString()).map(function(n){return n.charCodeAt(0)})},c.toHex=function(n){return(c.isNumber(n)?n:c.toString(n).charCodeAt(0)).toString(16)},c.toHexArray=function(n){return c.toArray(n).map(c.toHex)},c.toHexFormat=function(n){return c.toHexArray(n).map(function(n,t){return n+(++t%8?"":"\n")}).join(" ")};var l=/^(\w+):\/\/(.*?)\/(.*)$/;c.urlParse=function(n){var t=n.match(l);return t?{schema:t[1],host:t[2],href:t[3],hash:t[3].split("#")[1],query:t[3].split("?")[1]}:{}},c.apply=function(n,r){return n.apply(t,_toConsumableArray(r))},c.call=function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;t>e;e++)r[e-1]=arguments[e];return n(r)},c.create=function(n,t){return new(n=Function.prototype.bind.apply(n,[null].concat(t)))},c.factory=function(n){return function(){for(var t=arguments.length,r=Array(t),e=0;t>e;e++)r[e]=arguments[e];return c.create(n,r)}},c.defineValue=function(n,t,r){return Object.defineProperty(n,t,{writable:!0,enumerable:!1,configurable:!1,value:r})},c.defineGetter=function(n,t,r){return Object.defineProperty(n,t,{enumerable:!1,configurable:!1,get:r})},c.defineSetter=function(n,t,r){return Object.defineProperty(n,t,{enumerable:!1,configurable:!1,set:r})},c.defineGetterSetter=function(n,t,r,e){return Object.defineProperty(n,t,{enumerable:!1,configurable:!1,get:r,set:e})},c.range=function(n,t){return new Array(n).fill(t)},c.keys=function(n){return c.isFiniteNumber(n)?c.range(n,0):c.isObject(n)?Object.keys(n):Object.keys(n).map(c.toInt)},c.values=function(n){return Object.keys(n).map(function(t){return n[t]})},c.pairs=function(n){return c.keys(n).map(function(t){return c.toKeyValueOf(n,t)})},c.each=function(n,t){return c.keys(n).forEach(function(r){return t(n[r],r,n)})},c.every=function(n,t){return c.keys(n).every(function(r){return t(n[r],r,n)})},c.any=c.some=function(n,t){return c.keys(n).some(function(r){return t(n[r],r,n)})},c.merge=function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),u=1;t>u;u++)r[u-1]=arguments[u];if(!c.isValue(n))throw new TypeError("Cannot convert target to object");return r.filter(c.isStructure).forEach(function(t){return e(n,t,new WeakMap)}),n},c.clone=function(n){return c.isStructure(n)?e(c.isArray(n)?[]:{},n,[]):n},c.repeat=function(n,t){for(var r=0;n>r;)t(r++,n)},c.repeatHandled=function(n,t,r){for(var e=0;n>e;)r(t(e++,n))},c.map=function(n,t){return c.isObject(n)?c.keys(n).reduce(function(r,e){return r[e]=t(n[e],e,n),r},{}):c.isString(n)?c.toArray(n).map(t).join(""):c.toArray(n).map(t)},c.reduce=function(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),u=2;r>u;u++)e[u-2]=arguments[u];var a=c.keys(n),o=c.values(n);return e.unshift(function(r,e,u){return t(r,e,a[u],n)}),o.reduce.apply(o,e)},c.filter=function(n,t){var r=c.keys(n).reduce(function(r,e){return t(n[e],e,n)&&(r[e]=n[e]),r},c.isObject(n)?{}:[]);return c.isString(r)&&(r=r.join("")),r},c.first=function(n,t,r){var e;if(!c.keys(n).some(function(r){return t(n[r],r,n)?(e=r,!0):void 0})){if(c.isKeyValue(r))return r;e=r}return c.toKeyValueOf(n,e)},c.last=function(n,t,r){var e=c.keys(n).reduce(function(r,e){return t(n[e],e,n)&&(r=e),r},r);return c.isKeyValue(e)?e:c.toKeyValueOf(n,e)},c.lastReduce=function(n,t){var r=c.keys(n),e=r.reduce(function(r,e,u){return t(n[r],n[e],e,n)?e:r});return c.toKeyValueOf(n,e)},c.take=function(n,t){var r=c.first(n,t);return c.isObject(n)?delete n[r.key]:c.isArray(n)&&n.splice(r.key,1),r},c.takeReduce=function(n,t){var r=c.keys(n),e=r.reduce(function(r,e){var u=n[r],a=n[e];return t(u,a,r,n)===a?e:r}),u=c.toKeyValueOf(n,e);return c.isArray(n)?n.splice(u.key,1):delete n[u.key],u},c.sum=function(n){return c.values(n).reduce(function(n,t){return n+t},c.isString(n)?"":0)},c.max=function(n){return c.toKeyValueOf(n,c.keys(n).reduce(function(t,r){return n[t]>=n[r]?t:r}))},c.min=function(n){return c.toKeyValueOf(n,c.keys(n).reduce(function(t,r){return n[t]<=n[r]?t:r}))},c.countOf=function(n,t){return c.sum(c.values(n).map(function(n){return t===n?1:0}))},c.random=function(n,r){return n===t?Math.random():(r===t&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1)))},c.randomBool=function(){return Math.random()>.5},c.randomString=function(n){return c.range(n,"").map(function(n,t){return String.fromCharCode(c.random(n=c.randomBool()?65:97,n+25))}).join()},c.randomCase=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];var e=c.random(100),u=0;return c.first(t,function(n){return u+n>e?!0:void(u+=n)},t.length-1).key},c.randomGuid=function(){return u()+u()+"-"+u()+"-"+u()+"-"+u()+"-"+a()},c.shuffle=function(n){for(var t=c.values(n),r=[];t.length;)r.push(t.splice(c.random(t.length),1)[0]);return r},c.fnArgsCallFn=function(n){return function(){for(var t=arguments.length,r=Array(t),e=0;t>e;e++)r[e]=arguments[e];return n(r)}},c.fnArgsApplyFn=function(n){return function(r){return n.apply(t,_toConsumableArray(r))}},c.fnArgsValue=function(n,t){return t(n),n},c.fnEmpty=function(){},c.fnTrue=function(){return!0},c.fnFalse=function(){return!1},c.fnArgs=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return t},c.fnArg=function(n){return n},c.fnCallback=function(n){return function(t){return n(t)}},c.fnLog=function(){var n;return(n=console).log.apply(n,arguments)},c.fnPromise=function(n){return new Promise(n)},c.fnPromises=function(){return Promise.all(args.map(c.fnPromise))},c.stringToUpperCaseFirst=function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()},c.stringToPascalCase=function(n,t){return n.split(/[\s\-_\.,]+/g).map(c.stringToUpperCaseFirst).join(t||"")},c.stringToCamelCase=function(n){return(n=c.stringToPascalCase(n)).charAt(0).toLowerCase()+n.substr(1)},c.stringToCapitalize=function(n){return n.toUpperCase()},c.stringOccurrence=function(n,t){return(n.match(new RegExp(t,"g"))||[]).length},c.fmtString=function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;t>e;e++)r[e-1]=arguments[e];var u=n.toString();return 1==r.length&&c.isStructure(r[0])&&(r=r[0]),c.each(r,function(n,t){var r=new RegExp("\\{"+t+"\\}","g");u=u.replace(r,n)}),u};var g="000000000000000";c.fmtNumber=function(n,t,r){n=c.toInt(n),t=c.toInt(t);var e=Math.abs(n)+"",u=e.length;return e=t>u?(g+e).slice(-t):e,0>n?e="-"+e:r&&n>0&&(e="+"+e),e};var m={Y:function(n){return n.getFullYear()},y:function(n){return n.getFullYear()%100},M:function(n){return c.fmtNumber(n.getMonth()+1,2)},D:function(n){return c.fmtNumber(n.getDate(),2)},W:function(n){return c.fmtNumber(n.getDay(),2)},h:function(n){return c.fmtNumber(n.getHours(),2)},m:function(n){return c.fmtNumber(n.getMinutes(),2)},s:function(n){return c.fmtNumber(n.getSeconds(),2)},u:function(n){return n.getMilliseconds()},z:function(n){return n.getTimezoneOffset()},Z:function(n){var t=n.getTimezoneOffset()/60;return t?c.fmtNumber(0|t,2,!0)+":"+c.fmtNumber(Math.abs(t)%1*60,2):"Z"}};c.fmtDate=function(n,t){return c.toArray(t).map(function(t){return m[t]?m[t](n):t}).join("")},c.fmtDate.DATE_W3C="Y-M-DTh:m:sZ:00",c.fmtDate.DATE_XSD="Y-M-DTh:m:sZ",c.dateAddYears=function(n,t){return c.fnArgsValue(new Date(n),function(n){return n.setFullYear(n.getFullYear()+t)})},c.dateAddMonths=function(n,t){return c.fnArgsValue(new Date(n),function(n){return n.setMonth(n.getMonth()+t)})},c.dateAddDays=function(n,t){return c.fnArgsValue(new Date(n),function(n){return n.setDate(n.getDate()+t)})},c.dateAddHours=function(n,t){return c.fnArgsValue(new Date(n),function(n){return n.setHours(n.getHours()+t)})},c.dateAddMinutes=function(n,t){return c.fnArgsValue(new Date(n),function(n){return n.setMinutes(n.getMinutes()+t)})},c.dateAddSeconds=function(n,t){return c.fnArgsValue(new Date(n),function(n){return n.setSeconds(n.getSeconds()+t)})},c.dateToXsd=function(n){return c.fmtDate(n,c.fmtDate.DATE_XSD)},Date.begin=function(){var n=Date.now;return n.setTime(0),n},c.mathSqrDiff=function(n,t){return(n-=t)*n},c.mathSqrtSum=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return Math.pow(c.sum(t),.5)},c.mathDistanceEuclidean=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];var e=c.toInt(t.length/2),u=c.range(e,0).map(function(n,r){return c.mathSqrDiff(t[r],t[r+e])});return c.mathSqrtSum.apply(c,_toConsumableArray(u))},c.mathDistanceManhattan=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];var e=c.toInt(t.length/2),u=c.range(e,0).map(function(n,r){return Math.abs(t[r]-t[r+e])});return c.sum(u)},c.mathDistanceDiagonal=function(){for(var n,t=arguments.length,r=Array(t),e=0;t>e;e++)r[e]=arguments[e];var u=c.toInt(r.length/2),a=c.range(u,0).map(function(n,t){return Math.abs(r[t]-r[t+u])});return(n=Math).max.apply(n,_toConsumableArray(a))},c.mathPointId=function(n,t,r){return t*r+n},c.mathTransPoint=function(n,t,r,e){return{x:n+Math.cos(r)*e,y:t+Math.sin(r)*e}};var y=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}];c.pathfinderAStar=function(n,t,r,e,u,a,o,i){a=a||function(n,r){return c.mathDistanceManhattan(n-t.x,r-t.y)*l},o=o||r*e;var f,s=1,l=c.mathDistanceManhattan(n.x-t.x,n.y-t.y)+1,g={},m={},h={},p=function(n,t,r,e,o,i){var f=u(t,r),s=a(t,r),l=f+o,g=i+1;return{id:n||c.mathPointId(t,r),x:t,y:r,p:e,w:f,h:s,g:l,m:g,f:s+l}},d=function(n,t){return n.f<=t.f?n:t},v=function(n){s++,g[n.id]=h[n.id]=n,i&&i(n)},A=function(n){return p(0,f.x+n.x,f.y+n.y,f.id,f.g,f.m)},b=function(n){return n.x>=0&&n.x<r&&n.y>=0&&n.y<e&&n.w!=Number.MAX_VALUE&&!g[n.id]},O=[];for(n=p(c.mathPointId(n.x,n.y),n.x,n.y,-1,0,0),t=p(c.mathPointId(t.x,t.y),t.x,t.y,-1,0,0),g[n.id]=h[n.id]=n;s++<o&&Object.keys(h).length&&(f=c.takeReduce(h,d).value).id!=t.id;)m[f.id]=f,y.map(A).filter(b).forEach(v);if(f.id==t.id)do O.unshift({x:f.x,y:f.y,dx:t.x-f.x,dy:t.y-f.y}),t=f,f=m[f.p];while(-1!=f.p);return O};var h="eventListeners";c.eventOn=function(n,t,e){var u=r(n,h);return u[t]||(u[t]=[]),u[t].push({callback:e}),c},c.eventOnce=function(n,t,e){var u=r(n,h);return u[t]||(u[t]=[]),u[t].push({callback:e,once:1}),c},c.eventUn=function(n,t){for(var e=arguments.length,u=Array(e>2?e-2:0),a=2;e>a;a++)u[a-2]=arguments[a];var o=r(n,h);return o[t]&&(u.length?u.forEach(function(n){var r=o[t].indexOf(n);~r||o[t].splice(r,1)}):delete o[t]),c},c.eventGo=function(n,t){for(var e=arguments.length,u=Array(e>2?e-2:0),a=2;e>a;a++)u[a-2]=arguments[a];var o=r(n,h);return o[t]&&o[t].slice().forEach(function(n,r){n.callback.apply(n,u),n.once&&o[t].splice(r,1)}),c};var p="taskPool";c.taskPush=function(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),u=2;r>u;u++)e[u-2]=arguments[u];1==e.length&&c.isArray(e[0])&&(e=e[0]);var a=i(n,t);return a.push.apply(a,_toConsumableArray(e)),c},c.taskDelete=function(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),u=2;r>u;u++)e[u-2]=arguments[u];1==e.length&&c.isArray(e)&&(e=e[0]);var a=i(n,t);return e.forEach(function(n,t){~(t=a.indexOf(n))&&a.splice(t,1)}),c},c.taskWaitSync=function(n,r){for(var e=arguments.length,u=Array(e>2?e-2:0),a=2;e>a;a++)u[a-2]=arguments[a];return new Promise(function(e,a){try{var f=i(n,r).concat([e.bind(null,u[0])]);o.apply(t,[f].concat(u))}catch(c){a(c)}})},c.taskWaitAsync=function(n,r){for(var e=arguments.length,u=Array(e>2?e-2:0),a=2;e>a;a++)u[a-2]=arguments[a];return new Promise(function(e,a){try{var o;!function(){var a=i(n,r),f=function(){--o||e(u[0])};o=a.length+1,a.forEach(function(n){return n.apply(t,u.concat([f]))}),f()}()}catch(f){a(f)}})},c.pipe=function(n){return{pipe:c.pipe,push:function(){for(var t=arguments.length,r=Array(t),e=0;t>e;e++)r[e]=arguments[e];return r.map(n)}}},c.require=function(n){n=n.split("@");var t=n[1];n=n[0];var r=/[\\\/]/.test(n);t=c.isNotEmptyString(t)?t.split("."):[];try{return t.reduce(function(n,t){return n[t]},require(n))}catch(e){if(r)throw new Error("Please use absolute path for "+n);throw e}},f?module.exports=c:n._=c}("object"==("undefined"==typeof global?"undefined":_typeof(global))?global:"object"==("undefined"==typeof window?"undefined":_typeof(window))?window:void 0);